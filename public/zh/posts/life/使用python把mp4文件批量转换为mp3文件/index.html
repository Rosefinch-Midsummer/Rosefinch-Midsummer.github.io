<!DOCTYPE html>
<html lang="zh" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>使用Python把MP4文件批量转换为MP3文件 | 天漢帝國復興錄</title>
<meta name="keywords" content="Python">
<meta name="description" content="使用Python把MP4文件批量转换为MP3文件
前提：本地安装ffmpeg，可以选择安装pydub或是moviepy
使用Python调用ffmpeg需要安装ffmpeg-python
使用PyDub


 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26


import os
from pydub import AudioSegment


def convert_mp4_to_mp3(directory):
    for filename in os.listdir(directory):
        if filename.endswith(&#39;.mp4&#39;):
            mp4_file_path = os.path.join(directory, filename)
            mp3_file_path = os.path.splitext(mp4_file_path)[0] &#43; &#39;.mp3&#39;

            try:
                # 使用 pydub 转换 mp4 为 mp3
                audio = AudioSegment.from_file(mp4_file_path, format=&#39;mp4&#39;)
                audio.export(mp3_file_path, format=&#39;mp3&#39;)

                # 删除原有的 mp4 文件
                os.remove(mp4_file_path)
                print(f&#34;Converted {mp4_file_path} to {mp3_file_path} and deleted original mp4 file.&#34;)
            except Exception as e:
                print(f&#34;Error processing {mp4_file_path}: {e}&#34;)

            # 设置你的目标目录


target_directory = r&#39;E:\Entertainment\100s&#39;
convert_mp4_to_mp3(target_directory)


使用MoviePy


 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25


import os  
from moviepy.editor import VideoFileClip  

def convert_mp4_to_mp3(directory):  
    # 遍历目录  
    for filename in os.listdir(directory):  
        if filename.endswith(&#39;.mp4&#39;):  
            mp4_file_path = os.path.join(directory, filename)  
            mp3_file_path = os.path.splitext(mp4_file_path)[0] &#43; &#39;.mp3&#39;  
            
            try:  
                # 使用 moviepy 转换视频为音频  
                video_clip = VideoFileClip(mp4_file_path)  
                video_clip.audio.write_audiofile(mp3_file_path)  
                video_clip.close()  
                
                # 删除原有的 mp4 文件  
                os.remove(mp4_file_path)  
                print(f&#34;Converted {mp4_file_path} to {mp3_file_path} and deleted original mp4 file.&#34;)  
            except Exception as e:  
                print(f&#34;Error processing {mp4_file_path}: {e}&#34;)  

# 设置你的目标目录  
target_directory = r&#39;E:\Entertainment\北流嘉措&#39;  
convert_mp4_to_mp3(target_directory)


【最新】windows电脑FFmpeg安装教程手把手详解
windows电脑FFmpeg安装教程手把手详解教程来源">
<meta name="author" content="RM">
<link rel="canonical" href="https://rosefinch-midsummer.github.io/zh/posts/life/%E4%BD%BF%E7%94%A8python%E6%8A%8Amp4%E6%96%87%E4%BB%B6%E6%89%B9%E9%87%8F%E8%BD%AC%E6%8D%A2%E4%B8%BAmp3%E6%96%87%E4%BB%B6/">
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
  <meta name="referrer" content="no-referrer-when-downgrade">
<link crossorigin="anonymous" href="/assets/css/stylesheet.2211ca3164be7830024f6aad2b3a2e520843a64f8f048445c3401c1249aa051d.css" integrity="sha256-IhHKMWS&#43;eDACT2qtKzouUghDpk&#43;PBIRFw0AcEkmqBR0=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://rosefinch-midsummer.github.io/img/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://rosefinch-midsummer.github.io/img/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://rosefinch-midsummer.github.io/img/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://rosefinch-midsummer.github.io/img/apple-touch-icon.png">
<link rel="mask-icon" href="https://rosefinch-midsummer.github.io/img/android-chrome-192x192.png">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="zh" href="https://rosefinch-midsummer.github.io/zh/posts/life/%E4%BD%BF%E7%94%A8python%E6%8A%8Amp4%E6%96%87%E4%BB%B6%E6%89%B9%E9%87%8F%E8%BD%AC%E6%8D%A2%E4%B8%BAmp3%E6%96%87%E4%BB%B6/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css" integrity="sha384-R4558gYOUz8mP9YWpZJjofhk+zx0AS11p36HnD2ZKj/6JR5z27gSSULCNHIRReVs" crossorigin="anonymous"> 
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js" integrity="sha384-z1fJDqw8ZApjGO3/unPWUPsIymfsJmyrDVWC8Tv/a1HeOtGmkwNd/7xUS0Xcnvsx" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/auto-render.min.js" integrity="sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR" crossorigin="anonymous"></script>
<script> 
	document.addEventListener("DOMContentLoaded", function() { 
		renderMathInElement(document.body, { 
			
			
			delimiters: [ 
				{left: '$$', right: '$$', display: true}, 
				{left: '$', right: '$', display: false}, 
				{left: '\\(', right: '\\)', display: false}, 
				{left: '\\[', right: '\\]', display: true} 
			], 
			
			throwOnError : false 
		}); 
	}); 
</script>







<meta property="og:url" content="https://rosefinch-midsummer.github.io/zh/posts/life/%E4%BD%BF%E7%94%A8python%E6%8A%8Amp4%E6%96%87%E4%BB%B6%E6%89%B9%E9%87%8F%E8%BD%AC%E6%8D%A2%E4%B8%BAmp3%E6%96%87%E4%BB%B6/">
  <meta property="og:site_name" content="天漢帝國復興錄">
  <meta property="og:title" content="使用Python把MP4文件批量转换为MP3文件">
  <meta property="og:description" content="使用Python把MP4文件批量转换为MP3文件 前提：本地安装ffmpeg，可以选择安装pydub或是moviepy
使用Python调用ffmpeg需要安装ffmpeg-python
使用PyDub 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 import os from pydub import AudioSegment def convert_mp4_to_mp3(directory): for filename in os.listdir(directory): if filename.endswith(&#39;.mp4&#39;): mp4_file_path = os.path.join(directory, filename) mp3_file_path = os.path.splitext(mp4_file_path)[0] &#43; &#39;.mp3&#39; try: # 使用 pydub 转换 mp4 为 mp3 audio = AudioSegment.from_file(mp4_file_path, format=&#39;mp4&#39;) audio.export(mp3_file_path, format=&#39;mp3&#39;) # 删除原有的 mp4 文件 os.remove(mp4_file_path) print(f&#34;Converted {mp4_file_path} to {mp3_file_path} and deleted original mp4 file.&#34;) except Exception as e: print(f&#34;Error processing {mp4_file_path}: {e}&#34;) # 设置你的目标目录 target_directory = r&#39;E:\Entertainment\100s&#39; convert_mp4_to_mp3(target_directory) 使用MoviePy 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 import os from moviepy.editor import VideoFileClip def convert_mp4_to_mp3(directory): # 遍历目录 for filename in os.listdir(directory): if filename.endswith(&#39;.mp4&#39;): mp4_file_path = os.path.join(directory, filename) mp3_file_path = os.path.splitext(mp4_file_path)[0] &#43; &#39;.mp3&#39; try: # 使用 moviepy 转换视频为音频 video_clip = VideoFileClip(mp4_file_path) video_clip.audio.write_audiofile(mp3_file_path) video_clip.close() # 删除原有的 mp4 文件 os.remove(mp4_file_path) print(f&#34;Converted {mp4_file_path} to {mp3_file_path} and deleted original mp4 file.&#34;) except Exception as e: print(f&#34;Error processing {mp4_file_path}: {e}&#34;) # 设置你的目标目录 target_directory = r&#39;E:\Entertainment\北流嘉措&#39; convert_mp4_to_mp3(target_directory) 【最新】windows电脑FFmpeg安装教程手把手详解 windows电脑FFmpeg安装教程手把手详解教程来源">
  <meta property="og:locale" content="zh">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-02-07T18:34:25+08:00">
    <meta property="article:modified_time" content="2025-02-07T22:54:22+08:00">
    <meta property="article:tag" content="Python">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="使用Python把MP4文件批量转换为MP3文件">
<meta name="twitter:description" content="使用Python把MP4文件批量转换为MP3文件
前提：本地安装ffmpeg，可以选择安装pydub或是moviepy
使用Python调用ffmpeg需要安装ffmpeg-python
使用PyDub


 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26


import os
from pydub import AudioSegment


def convert_mp4_to_mp3(directory):
    for filename in os.listdir(directory):
        if filename.endswith(&#39;.mp4&#39;):
            mp4_file_path = os.path.join(directory, filename)
            mp3_file_path = os.path.splitext(mp4_file_path)[0] &#43; &#39;.mp3&#39;

            try:
                # 使用 pydub 转换 mp4 为 mp3
                audio = AudioSegment.from_file(mp4_file_path, format=&#39;mp4&#39;)
                audio.export(mp3_file_path, format=&#39;mp3&#39;)

                # 删除原有的 mp4 文件
                os.remove(mp4_file_path)
                print(f&#34;Converted {mp4_file_path} to {mp3_file_path} and deleted original mp4 file.&#34;)
            except Exception as e:
                print(f&#34;Error processing {mp4_file_path}: {e}&#34;)

            # 设置你的目标目录


target_directory = r&#39;E:\Entertainment\100s&#39;
convert_mp4_to_mp3(target_directory)


使用MoviePy


 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25


import os  
from moviepy.editor import VideoFileClip  

def convert_mp4_to_mp3(directory):  
    # 遍历目录  
    for filename in os.listdir(directory):  
        if filename.endswith(&#39;.mp4&#39;):  
            mp4_file_path = os.path.join(directory, filename)  
            mp3_file_path = os.path.splitext(mp4_file_path)[0] &#43; &#39;.mp3&#39;  
            
            try:  
                # 使用 moviepy 转换视频为音频  
                video_clip = VideoFileClip(mp4_file_path)  
                video_clip.audio.write_audiofile(mp3_file_path)  
                video_clip.close()  
                
                # 删除原有的 mp4 文件  
                os.remove(mp4_file_path)  
                print(f&#34;Converted {mp4_file_path} to {mp3_file_path} and deleted original mp4 file.&#34;)  
            except Exception as e:  
                print(f&#34;Error processing {mp4_file_path}: {e}&#34;)  

# 设置你的目标目录  
target_directory = r&#39;E:\Entertainment\北流嘉措&#39;  
convert_mp4_to_mp3(target_directory)


【最新】windows电脑FFmpeg安装教程手把手详解
windows电脑FFmpeg安装教程手把手详解教程来源">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "📚文章",
      "item": "https://rosefinch-midsummer.github.io/zh/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "🏖生活",
      "item": "https://rosefinch-midsummer.github.io/zh/posts/life/"
    }, 
    {
      "@type": "ListItem",
      "position":  3 ,
      "name": "使用Python把MP4文件批量转换为MP3文件",
      "item": "https://rosefinch-midsummer.github.io/zh/posts/life/%E4%BD%BF%E7%94%A8python%E6%8A%8Amp4%E6%96%87%E4%BB%B6%E6%89%B9%E9%87%8F%E8%BD%AC%E6%8D%A2%E4%B8%BAmp3%E6%96%87%E4%BB%B6/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "使用Python把MP4文件批量转换为MP3文件",
  "name": "使用Python把MP4文件批量转换为MP3文件",
  "description": "使用Python把MP4文件批量转换为MP3文件 前提：本地安装ffmpeg，可以选择安装pydub或是moviepy\n使用Python调用ffmpeg需要安装ffmpeg-python\n使用PyDub 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 import os from pydub import AudioSegment def convert_mp4_to_mp3(directory): for filename in os.listdir(directory): if filename.endswith(\u0026#39;.mp4\u0026#39;): mp4_file_path = os.path.join(directory, filename) mp3_file_path = os.path.splitext(mp4_file_path)[0] + \u0026#39;.mp3\u0026#39; try: # 使用 pydub 转换 mp4 为 mp3 audio = AudioSegment.from_file(mp4_file_path, format=\u0026#39;mp4\u0026#39;) audio.export(mp3_file_path, format=\u0026#39;mp3\u0026#39;) # 删除原有的 mp4 文件 os.remove(mp4_file_path) print(f\u0026#34;Converted {mp4_file_path} to {mp3_file_path} and deleted original mp4 file.\u0026#34;) except Exception as e: print(f\u0026#34;Error processing {mp4_file_path}: {e}\u0026#34;) # 设置你的目标目录 target_directory = r\u0026#39;E:\\Entertainment\\100s\u0026#39; convert_mp4_to_mp3(target_directory) 使用MoviePy 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 import os from moviepy.editor import VideoFileClip def convert_mp4_to_mp3(directory): # 遍历目录 for filename in os.listdir(directory): if filename.endswith(\u0026#39;.mp4\u0026#39;): mp4_file_path = os.path.join(directory, filename) mp3_file_path = os.path.splitext(mp4_file_path)[0] + \u0026#39;.mp3\u0026#39; try: # 使用 moviepy 转换视频为音频 video_clip = VideoFileClip(mp4_file_path) video_clip.audio.write_audiofile(mp3_file_path) video_clip.close() # 删除原有的 mp4 文件 os.remove(mp4_file_path) print(f\u0026#34;Converted {mp4_file_path} to {mp3_file_path} and deleted original mp4 file.\u0026#34;) except Exception as e: print(f\u0026#34;Error processing {mp4_file_path}: {e}\u0026#34;) # 设置你的目标目录 target_directory = r\u0026#39;E:\\Entertainment\\北流嘉措\u0026#39; convert_mp4_to_mp3(target_directory) 【最新】windows电脑FFmpeg安装教程手把手详解 windows电脑FFmpeg安装教程手把手详解教程来源\n",
  "keywords": [
    "Python"
  ],
  "articleBody": "使用Python把MP4文件批量转换为MP3文件 前提：本地安装ffmpeg，可以选择安装pydub或是moviepy\n使用Python调用ffmpeg需要安装ffmpeg-python\n使用PyDub 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 import os from pydub import AudioSegment def convert_mp4_to_mp3(directory): for filename in os.listdir(directory): if filename.endswith('.mp4'): mp4_file_path = os.path.join(directory, filename) mp3_file_path = os.path.splitext(mp4_file_path)[0] + '.mp3' try: # 使用 pydub 转换 mp4 为 mp3 audio = AudioSegment.from_file(mp4_file_path, format='mp4') audio.export(mp3_file_path, format='mp3') # 删除原有的 mp4 文件 os.remove(mp4_file_path) print(f\"Converted {mp4_file_path} to {mp3_file_path} and deleted original mp4 file.\") except Exception as e: print(f\"Error processing {mp4_file_path}: {e}\") # 设置你的目标目录 target_directory = r'E:\\Entertainment\\100s' convert_mp4_to_mp3(target_directory) 使用MoviePy 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 import os from moviepy.editor import VideoFileClip def convert_mp4_to_mp3(directory): # 遍历目录 for filename in os.listdir(directory): if filename.endswith('.mp4'): mp4_file_path = os.path.join(directory, filename) mp3_file_path = os.path.splitext(mp4_file_path)[0] + '.mp3' try: # 使用 moviepy 转换视频为音频 video_clip = VideoFileClip(mp4_file_path) video_clip.audio.write_audiofile(mp3_file_path) video_clip.close() # 删除原有的 mp4 文件 os.remove(mp4_file_path) print(f\"Converted {mp4_file_path} to {mp3_file_path} and deleted original mp4 file.\") except Exception as e: print(f\"Error processing {mp4_file_path}: {e}\") # 设置你的目标目录 target_directory = r'E:\\Entertainment\\北流嘉措' convert_mp4_to_mp3(target_directory) 【最新】windows电脑FFmpeg安装教程手把手详解 windows电脑FFmpeg安装教程手把手详解教程来源\n本文以 Windows 64 位操作系统为例演示\n一、下载\u0026解压\n打开 FFmpeg 官网，选择下载。\n选择 Windows 平台，下面有两个链接，都是可以的，选择其一。\n本文以点击第一个链接为例，进去以后，选择左边的 release builds ，右边出现如下内容：\n你可以选择下载上面红色圈中的 release-full 版本，或者选择下面红色圈中的前一个稳定版本 xxx-full_build。\nrelease-full 版本会比下面的 xxx-full_build 版本更新，选择哪一个都可以，看你个人喜好。\n至于你是想选择带 shared 的还是不带 shared 的版本，其实都是可以的。因为同一个版本带 shared 的和不带 shared 的，功能是完全一样的。\n带 shared 的里面，多了 include、lib 目录。把 FFmpeg 依赖的模块包单独的放在的 lib 目录中。ffmpeg.exe，ffplay.exe，ffprobe.exe 作为可执行文件的入口，文件体积很小，他们在运行的时候，如果需要，会到 lib 中调用相应的功能。\n不带 shared 的里面，bin 目录中有 ffmpeg.exe，ffplay.exe，ffprobe.exe 三个可执行文件，每个 exe 的体积都稍大一点，因为它已经把相关的需要用的模块包编译到exe里面去了。\n解压以后的内容，如上图所示；进入 bin 目录，复制 bin 目录路径。\n二、配置环境变量\n1、配置系统环境变量\n1、在电脑桌面上，打开我的电脑\n2、在空白处，右键，选择属性\n3、选择 高级系统设置 -\u003e 高级 -\u003e 环境变量\n4、在系统变量中，选择 Path，然后编辑：\n5、然后在出来的编辑环境变量表中，新建一个，将刚才复制的 bin 目录路径粘贴进去，保存即可。\n三、验证\n重新打开一个命令行窗口，输入： ffmpeg -version，有版本信息输出，则证明配置成功！！\n执行Python代码需要重启PyCharm。\n额外补充\n对于 windows 电脑可以将解压文件放到系统的 system32 目录中去，就不用配置环境变量了。\nPyDub入门教程 Python音频处理利器：pydub详解\nPydub 是一个用 Python 编写的音频处理库，它可以方便地处理许多音频文件，诸如分割、合并、格式转换、音量调节等。它具有以下特点：\n主要使用 ffmpeg 和 libav 模块来实现音频的读取、处理和输出。 支持的音频格式非常广泛，包括 MP3、WAV、FLAC、MP4 等。 API 简单易用，可以方便地进行常用的音频处理操作。 Pydub 是一个轻量级、快速且易于使用的库。silence库是pydub的一个扩展库，可以在音频文件中根据静默部分进行分割，非常方便。\n1 pydub安装 安装 Pydub 的最简单方法是使用 pip，只需在命令行下运行以下命令即可：\n1 pip install pydub 依赖：需安装ffmpeg或者libav\n如果 ffmpeg 或 libav 未安装，则还需要在系统中安装相关依赖库。\n2 pydub模块使用 读取音频文件非常简单，只需使用 AudioSegment.from_file() 函数即可。以下示例演示了如何读取名为 “soundfile.mp3” 的 MP3 文件：\n2.1 打开音频文件 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 from pydub import AudioSegment # 打开wav格式音频文件 sound = AudioSegment.from_wav('./soundfile.wav') # 打开mp3音频文件，AudioSegment原生只支持wav，raw文件，安装ffmpeg可支持其所有格式 sound = AudioSegment.from_mp3('./soundfile.mp3') # 打开音频文件，生成AudioSegment对象 sound = AudioSegment.from_file('./soundfile.mp3')\t# format默认值为\"mp3\" sound = AudioSegment.from_file('./soundfile.wav', format='wav') # 打开raw文件需要额外参数，sample_width（采样位数），frame_rate（采样频率），channels（声通道） # sample_width: 1、8bit，2、16bit，3、32bit # frame_rate: 44100(44.1kHz CD audio), 48000(48kHz DVD audio) # channels: 1、单声道，2、立体声 sound = AudioSegment.from_file('./soundfile.raw', format='raw', frame_rate=44100, channels=2, sample_width=2) 2.2 导出音频文件 要将 AudioSegment 对象保存为音频文件，可以使用 export() 函数。以下示例将上述读取的音频输出为名为 “outputsoundfile.mp3” 的 mp3文件：\n1 2 3 4 sound = AudioSegment.from_file('./soundfile.wav', format='wav') # 导出音频文件 sound.export('./outputsoundfile.mp3', format='mp3') 2.3 创建音频文件 1 2 3 4 5 6 # 生成一个时间长度为0秒的AudioSegment对象，一般用于多个音频合并 sound = AudioSegment.empty() # 生成一个时间长度为5秒的无声AduioSegment对象 # 参数duration:时间长度（毫秒），frame_rate:频率，默认为11025Hz sound = AudioSegment.silent(duration=50000) 2.4 合并音频文件 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 # 两个单声道音频合并为一个多声道音频 left_channel = AudioSegment.from_wav('sound_left.wav') right_channel = AudioSegment.from_wav('sound_right.wav') stereo_sound = AudioSegment.from_mono_auidosegments(left_channel,right_channel) # 将多声道音频分解成两个单声道 sound = AudioSegment.from_wav('sound.wav') sound.split_to_mono() # 两个音频文件合并为一个音频文件 sound1 = AudioSegment.from_file('sound1.wav', format='wav') sound2 = AudioSegment.from_file('sound2.wav', format='wav') # 无交叉淡入淡出 sound = sound1 + sound2 # OR sound = sound1.append(sound2, crossfade=0) # 淡入淡出，参数crossfade:效果持续时间，默认100毫秒 sound = sound1.append(sound2, crossfade=100) # 两个音频文件叠加为一个音频文件 # 例，长音频sound1，30s sound1 = AudioSegment.from_file('sound1.wav', format='wav') # 例，短音频sound2，10s sound2 = AudioSegment.from_file('sound2.wav', format='wav') # 将sound2叠加至sound1上，参数postions:从sound1音频10秒处开始叠加，默认为0，得到的音频文件，会从10秒处开始出现sound2音频，20秒处sound2音频结束，只余sound1音频 sound = sound1.overlay(sound2, postions=10000) # 将sound2叠加至sound1上，参数loop:开启循环，默认为Fasle，得到的音频文件sound2将会循环播放至sound1结束 sound = sound1.overlay(sound2, loop=true) # 将sound2叠加至sound1上，参数times:重复次数，默认为1，得到的音频文件sound2将会重复两次，在两个sound2的时间结束sound2音频 sound = sound1.overlay(sound2, times=2) # 将sound1叠加至sound2上，10秒后sound2音频结束，sound1音频截断至10s结束，最终该音频长度只有10s，即 sound = sound2.overlay(sound1) len(sound) == sound2 2.5 音频文件信息 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 sound = AudioSegment.from_file('soundfile.wav', format='wav') # 声道数 schannel = sound.channels # 采样位数，也称位深度，是指每个采样样本所包含的位数（字节数），通常有8 bit、16 bit sbytes = sound.sample_width # 采样频率，也称采样率，是指在单位时间内对声音信号的采样数或样本数，采样频率越能高表现的频率范围越大（电话：8kHZ，无线电广播：22.05kHz，CD：44.1kHz，DVD：48kHZ，蓝光：96kHz，192kHz） srate = sound.frame_rate # 帧位数, 帧包含每个声道的采样位数frame_width = channels * sample_width sframebytes = sound.frame_width # 音频文件帧数, 可选参数ms:时间长度，默认None sframe = sound.frame_count() # 音频文件时长，单位秒 stime = sound.duration_seconds # OR stime = (len(sound) / 1000) 2.6 处理音频文件 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 sound = AudioSegment.from_file('soundfile.wav', format='wav') # 音频前5秒，pydub中时间以毫秒（ms）为单位 audio_begin = sound[:5000] # 音频后5秒，pydub中时间以毫秒（ms）为单位 audio_end = sound[-5000:] # 改变音频幅度，以分贝（dB）为单位 # 调高幅度 raise_via = sound.apply_gain(+5) raise_via = sound + 5 # 调低音量 lower_via = sound.apply_gain(-5) lower_via = sound - 5 # 淡入淡出效果 # 淡入，参数duration:持续时间 sound.fade_in(duration=5000) # 淡出，参数duration:持续时间 sound.fade_out(duration=5000) # 倒放音频文件 newsound = sound.reverse() 2.7 播放音频文件 1 2 3 4 5 6 7 8 from pydub import playback from pydub import AduioSegment from pydub.playback import play sound = AduioSegment.from_wav('sound.wav') # 播放音频 play(sound) 2.8 分割音频 1 2 3 4 5 6 7 8 from pydub import utils from pydub import AudioSegment from pydub.utils import make_chanks sound = AduioSegment.from_wav('sound.wav') # 分割音频, 参数chunk_length:一段音频多长时间 make_chanks(sound, chunk_length=5000) 3 使用pydub根据静音分割音频 3.1 静音检测原理 静音检测原理是通过分析音频信号的能量，判断其是否为静音状态。具体的原理如下：\n音频信号通常可以用时域或频域来表示。对于时域表示，可以将音频信号分成一段一段的小块，每个小块称为帧。对于频域表示，可以将音频信号变换为频谱图。\n静音的特点是信号的能量较低，通常处于接近零的水平。因此，静音检测可以通过计算每个帧或频谱图的能量来判断是否为静音。\n计算能量的方法可以使用绝对能量或相对能量。绝对能量是指计算信号的平方和，即将信号的每个样本取平方后相加。相对能量是指计算信号的功率谱密度，即将信号的功率谱密度求和。\n静音检测的阈值是根据实际应用来确定的。通常可以根据经验设置一个合适的阈值，当帧的能量或频谱图的能量低于阈值时，被判断为静音。\n静音检测也可以结合其他特征进行判断，例如零交叉率、短时过零率等。这些特征可以提供更准确的静音检测结果。\n静音检测原理是通过计算音频信号的能量来判断是否为静音状态，通常通过设置一个阈值来判断。此外，还可以结合其他特征进行判断，提高检测的准确性。\n语音和噪声的区别可以体现在他们的能量上，语音段的能量比噪声段的能量大，如果环境噪声和系统输入的噪声比较小，只要计算输入信号的短时能量就能够把语音段和噪声背景区分开，除此之外，用基于能量的算法来检测浊音通常效果也是比较理想的，因为浊音的能量值比清音大得多，可以判断浊音和清音之间过渡的时刻，但对清音来说，效果不是很好，因此还需要借助短时过零率来表征。\n短时能量可以近似为互补的情况，短时能量大的地方过零率小，短时能量小的地方过零率较大。\n基于短时能量和过零率的检测方法 尽管基于短时能量和过零率的检测方法各有其优缺点，但是若将这两种基本方法相结合起来使用也可以实现对语音信号可靠的端点检测。无声段的短时能量为零，清音段的短时能量又比浊音段的短时能量大，而在过零率方面，理想的情况是无声段的过零率为零，浊音段的过零率比清音段的过零率要大的多，假设有一段语音，如果某部分短时能量和过零率都为零或者为很小的值，就可以认为这部分为无声段。\n如果该部分语音短时能量很大但是过零率很小，则认为该部分语音为浊音段。\n如果该部分短时能量很小但是过零率很大，则认为该部分语音为清音段。\n正如前面提到，语音信号具有短时性，因此在对语音信号进行分析时，需要将语音信号以30ms为一段分为若干帧来进行分析，则两帧起始点之间的间隔为10ms。\n短时能量，无声\u003c浊音\u003c清音\n过零率，无声\u003c清音\u003c浊音\n3.2 使用pydub进行静音检测 代码首先使用AudioSegment类从audio.mp3文件中读取音频数据，然后设置了分割参数min_silence_len、silence_thresh和keep_silence。min_silence_len是最小静音长度，silence_thresh是静音阈值，keep_silence是保留静音长度。这些参数的具体含义可以根据实际情况进行调整。最后，根据分割参数使用split_on_silence函数对音频文件进行分割。\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 from pydub import AudioSegment from pydub.silence import split_on_silence # 读取音频文件 audio = AudioSegment.from_file(\"D:/dataset/lyb01.wav\", format=\"wav\") # 设置分割参数 min_silence_len = 300 # 最小静音长度 silence_thresh = -50 # 静音阈值，越小越严格 keep_silence = 200 # 保留静音长度 # 分割音频文件 segments = split_on_silence(audio, min_silence_len=min_silence_len, silence_thresh=silence_thresh, keep_silence=keep_silence) for idx in range(len(segments)): segments[idx].export(f'wav_{idx:04}.wav') 4 总结 通过pydub，我们可以方便地进行音频编解码、混音、重采样等操作，进一步扩展了pydub的应用场景。需要注意的是，在进行音频混音操作时，需要保证两个音频文件的采样率、采样位数和声道数相同。\npydub优点：\n轻量级：pydub是一个轻量级的音频处理库，安装方便，使用简单。\n功能丰富：pydub提供了丰富的音频处理功能，包括切割、合并、转换、调整音量、编解码、混音、重采样等。\n应用广泛：pydub的应用场景非常广泛，包括音频处理、铃声制作、音频格式转换、语音识别等等。\npydub缺点：\n对格式的兼容性有限：pydub对音频格式的兼容性有限，不支持所有的音频格式，需要先将音频转换为支持的格式后才能进行处理。\n性能一般：pydub在处理大文件时，性能可能会比较一般，需要耗费一定的时间和计算资源。 不支持流式处理：pydub不支持流式处理，需要将整个音频文件读取到内存中，导致内存占用较大。\npydub是一个功能丰富、应用广泛的音频处理库。在使用pydub时，需要注意音频格式的兼容性问题，并注意处理大文件时的性能和内存占用。如果需要处理更复杂的音频任务，可以考虑使用其他更专业的音频处理库。\nMoviePy入门教程 Video editing with Python\nzulko.github.io/moviepy/\nMoviePy (online documentation here) is a Python library for video editing: cuts, concatenations, title insertions, video compositing (a.k.a. non-linear editing), video processing, and creation of custom effects.\nMoviePy can read and write all the most common audio and video formats, including GIF, and runs on Windows/Mac/Linux, with Python 3.9+.\nExample In this example we open a video file, select the subclip between 10 and 20 seconds, add a title at the center of the screen, and write the result to a new file:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 from moviepy import VideoFileClip, TextClip, CompositeVideoClip # Load file example.mp4 and keep only the subclip from 00:00:10 to 00:00:20 # Reduce the audio volume to 80% of its original volume clip = ( VideoFileClip(\"long_examples/example2.mp4\") .subclipped(10, 20) .with_volume_scaled(0.8) ) # Generate a text clip. You can customize the font, color, etc. txt_clip = TextClip( font=\"Arial.ttf\", text=\"Hello there!\", font_size=70, color='white' ).with_duration(10).with_position('center') # Overlay the text clip on the first video clip final_video = CompositeVideoClip([clip, txt_clip]) final_video.write_videofile(\"result.mp4\") How MoviePy works Under the hood, MoviePy imports media (video frames, images, sounds) and converts them into Python objects (numpy arrays) so that every pixel becomes accessible, and video or audio effects can be defined in just a few lines of code (see the built-in effects for examples).\nThe library also provides ways to mix clips together (concatenations, playing clips side by side or on top of each other with transparency, etc.). The final clip is then encoded back into mp4/webm/gif/etc.\nThis makes MoviePy very flexible and approachable, albeit slower than using ffmpeg directly due to heavier data import/export operations.\nInstallation Intall moviepy with pip install moviepy. For additional installation options, such as a custom FFMPEG or for previewing, see this section. For development, clone that repo locally and install with pip install -e .\nDocumentation The online documentation (here) is automatically built at every push to the master branch. To build the documentation locally, install the extra dependencies via pip install moviepy[doc], then go to the docs folder and run make html.\nmoviepy，一个超酷的 Python 库！ 文章来源\n",
  "wordCount" : "5323",
  "inLanguage": "zh",
  "datePublished": "2025-02-07T18:34:25+08:00",
  "dateModified": "2025-02-07T22:54:22+08:00",
  "author":{
    "@type": "Person",
    "name": "RM"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://rosefinch-midsummer.github.io/zh/posts/life/%E4%BD%BF%E7%94%A8python%E6%8A%8Amp4%E6%96%87%E4%BB%B6%E6%89%B9%E9%87%8F%E8%BD%AC%E6%8D%A2%E4%B8%BAmp3%E6%96%87%E4%BB%B6/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "天漢帝國復興錄",
    "logo": {
      "@type": "ImageObject",
      "url": "https://rosefinch-midsummer.github.io/img/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://rosefinch-midsummer.github.io/zh/" accesskey="h" title="天漢帝國復興錄 (Alt + H)">天漢帝國復興錄</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://rosefinch-midsummer.github.io/zh/" title="🏠主頁">
                    <span>🏠主頁</span>
                </a>
            </li>
            <li>
                <a href="https://rosefinch-midsummer.github.io/zh/posts" title="📚文章">
                    <span>📚文章</span>
                </a>
            </li>
            <li>
                <a href="https://rosefinch-midsummer.github.io/zh/search" title="🔍搜索 (Alt &#43; /)" accesskey=/>
                    <span>🔍搜索</span>
                </a>
            </li>
            <li>
                <a href="https://rosefinch-midsummer.github.io/zh/archives" title="⏱時間軸">
                    <span>⏱時間軸</span>
                </a>
            </li>
            <li>
                <a href="https://rosefinch-midsummer.github.io/zh/categories" title="🧩分類">
                    <span>🧩分類</span>
                </a>
            </li>
            <li>
                <a href="https://rosefinch-midsummer.github.io/zh/tags" title="🔖標簽">
                    <span>🔖標簽</span>
                </a>
            </li>
            <li>
                <a href="https://rosefinch-midsummer.github.io/zh/about" title="🙋🏻‍♂️關于">
                    <span>🙋🏻‍♂️關于</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://rosefinch-midsummer.github.io/zh/">首頁</a>&nbsp;»&nbsp;<a href="https://rosefinch-midsummer.github.io/zh/posts/">📚文章</a>&nbsp;»&nbsp;<a href="https://rosefinch-midsummer.github.io/zh/posts/life/">🏖生活</a></div>
    <h1 class="post-title">
      使用Python把MP4文件批量转换为MP3文件
    </h1>
    <div class="post-meta">
    创建: 2025-02-07 |
    更新: 2025-02-07 |
    字数: 5323字 |
    时长: 11分钟 |
    RM


</div>
   
<div  class="meta-item">&nbsp·&nbsp
  <span id="busuanzi_container_page_pv">本文阅读量<span id="busuanzi_value_page_pv"></span>次</span>
</div>


  </header> <div class="toc">
    <details  open>
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">目錄</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#%e4%bd%bf%e7%94%a8python%e6%8a%8amp4%e6%96%87%e4%bb%b6%e6%89%b9%e9%87%8f%e8%bd%ac%e6%8d%a2%e4%b8%bamp3%e6%96%87%e4%bb%b6" aria-label="使用Python把MP4文件批量转换为MP3文件">使用Python把MP4文件批量转换为MP3文件</a><ul>
                        
                <li>
                    <a href="#%e4%bd%bf%e7%94%a8pydub" aria-label="使用PyDub">使用PyDub</a></li>
                <li>
                    <a href="#%e4%bd%bf%e7%94%a8moviepy" aria-label="使用MoviePy">使用MoviePy</a></li></ul>
                </li>
                <li>
                    <a href="#%e6%9c%80%e6%96%b0windows%e7%94%b5%e8%84%91ffmpeg%e5%ae%89%e8%a3%85%e6%95%99%e7%a8%8b%e6%89%8b%e6%8a%8a%e6%89%8b%e8%af%a6%e8%a7%a3" aria-label="【最新】windows电脑FFmpeg安装教程手把手详解">【最新】windows电脑FFmpeg安装教程手把手详解</a></li>
                <li>
                    <a href="#pydub%e5%85%a5%e9%97%a8%e6%95%99%e7%a8%8b" aria-label="PyDub入门教程">PyDub入门教程</a><ul>
                        
                <li>
                    <a href="#1-pydub%e5%ae%89%e8%a3%85" aria-label="1 pydub安装">1 pydub安装</a></li>
                <li>
                    <a href="#2--pydub%e6%a8%a1%e5%9d%97%e4%bd%bf%e7%94%a8" aria-label="2  pydub模块使用">2  pydub模块使用</a><ul>
                        
                <li>
                    <a href="#21-%e6%89%93%e5%bc%80%e9%9f%b3%e9%a2%91%e6%96%87%e4%bb%b6" aria-label="2.1 打开音频文件">2.1 打开音频文件</a></li>
                <li>
                    <a href="#22-%e5%af%bc%e5%87%ba%e9%9f%b3%e9%a2%91%e6%96%87%e4%bb%b6" aria-label="2.2 导出音频文件">2.2 导出音频文件</a></li>
                <li>
                    <a href="#23-%e5%88%9b%e5%bb%ba%e9%9f%b3%e9%a2%91%e6%96%87%e4%bb%b6" aria-label="2.3 创建音频文件">2.3 创建音频文件</a></li>
                <li>
                    <a href="#24-%e5%90%88%e5%b9%b6%e9%9f%b3%e9%a2%91%e6%96%87%e4%bb%b6" aria-label="2.4 合并音频文件">2.4 合并音频文件</a></li>
                <li>
                    <a href="#25-%e9%9f%b3%e9%a2%91%e6%96%87%e4%bb%b6%e4%bf%a1%e6%81%af" aria-label="2.5 音频文件信息">2.5 音频文件信息</a></li>
                <li>
                    <a href="#26-%e5%a4%84%e7%90%86%e9%9f%b3%e9%a2%91%e6%96%87%e4%bb%b6" aria-label="2.6 处理音频文件">2.6 处理音频文件</a></li>
                <li>
                    <a href="#27-%e6%92%ad%e6%94%be%e9%9f%b3%e9%a2%91%e6%96%87%e4%bb%b6" aria-label="2.7 播放音频文件">2.7 播放音频文件</a></li>
                <li>
                    <a href="#28-%e5%88%86%e5%89%b2%e9%9f%b3%e9%a2%91" aria-label="2.8 分割音频">2.8 分割音频</a></li></ul>
                </li>
                <li>
                    <a href="#3-%e4%bd%bf%e7%94%a8pydub%e6%a0%b9%e6%8d%ae%e9%9d%99%e9%9f%b3%e5%88%86%e5%89%b2%e9%9f%b3%e9%a2%91" aria-label="3 使用pydub根据静音分割音频">3 使用pydub根据静音分割音频</a><ul>
                        
                <li>
                    <a href="#31-%e9%9d%99%e9%9f%b3%e6%a3%80%e6%b5%8b%e5%8e%9f%e7%90%86" aria-label="3.1 静音检测原理">3.1 静音检测原理</a></li>
                <li>
                    <a href="#32-%e4%bd%bf%e7%94%a8pydub%e8%bf%9b%e8%a1%8c%e9%9d%99%e9%9f%b3%e6%a3%80%e6%b5%8b" aria-label="3.2 使用pydub进行静音检测">3.2 使用pydub进行静音检测</a></li></ul>
                </li>
                <li>
                    <a href="#4-%e6%80%bb%e7%bb%93" aria-label="4 总结">4 总结</a></li></ul>
                </li>
                <li>
                    <a href="#moviepy%e5%85%a5%e9%97%a8%e6%95%99%e7%a8%8b" aria-label="MoviePy入门教程">MoviePy入门教程</a><ul>
                        
                <li>
                    <a href="#example" aria-label="Example">Example</a></li>
                <li>
                    <a href="#how-moviepy-works" aria-label="How MoviePy works">How MoviePy works</a></li>
                <li>
                    <a href="#installation" aria-label="Installation">Installation</a></li>
                <li>
                    <a href="#documentation" aria-label="Documentation">Documentation</a></li>
                <li>
                    <a href="#moviepy%e4%b8%80%e4%b8%aa%e8%b6%85%e9%85%b7%e7%9a%84-python-%e5%ba%93" aria-label="moviepy，一个超酷的 Python 库！">moviepy，一个超酷的 Python 库！</a>
                </li>
            </ul>
            </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h1 id="使用python把mp4文件批量转换为mp3文件">使用Python把MP4文件批量转换为MP3文件<a hidden class="anchor" aria-hidden="true" href="#使用python把mp4文件批量转换为mp3文件">#</a></h1>
<p>前提：本地安装ffmpeg，可以选择安装pydub或是moviepy</p>
<p>使用Python调用ffmpeg需要安装ffmpeg-python</p>
<h2 id="使用pydub">使用PyDub<a hidden class="anchor" aria-hidden="true" href="#使用pydub">#</a></h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">os</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pydub</span> <span class="kn">import</span> <span class="n">AudioSegment</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">convert_mp4_to_mp3</span><span class="p">(</span><span class="n">directory</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">directory</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">filename</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;.mp4&#39;</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="n">mp4_file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">directory</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">mp3_file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">mp4_file_path</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;.mp3&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="c1"># 使用 pydub 转换 mp4 为 mp3</span>
</span></span><span class="line"><span class="cl">                <span class="n">audio</span> <span class="o">=</span> <span class="n">AudioSegment</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="n">mp4_file_path</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;mp4&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="n">audio</span><span class="o">.</span><span class="n">export</span><span class="p">(</span><span class="n">mp3_file_path</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;mp3&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                <span class="c1"># 删除原有的 mp4 文件</span>
</span></span><span class="line"><span class="cl">                <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">mp4_file_path</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Converted </span><span class="si">{</span><span class="n">mp4_file_path</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">mp3_file_path</span><span class="si">}</span><span class="s2"> and deleted original mp4 file.&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Error processing </span><span class="si">{</span><span class="n">mp4_file_path</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1"># 设置你的目标目录</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">target_directory</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;E:\Entertainment\100s&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">convert_mp4_to_mp3</span><span class="p">(</span><span class="n">target_directory</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="使用moviepy">使用MoviePy<a hidden class="anchor" aria-hidden="true" href="#使用moviepy">#</a></h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">os</span>  
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">moviepy.editor</span> <span class="kn">import</span> <span class="n">VideoFileClip</span>  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">convert_mp4_to_mp3</span><span class="p">(</span><span class="n">directory</span><span class="p">):</span>  
</span></span><span class="line"><span class="cl">    <span class="c1"># 遍历目录  </span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">directory</span><span class="p">):</span>  
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">filename</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;.mp4&#39;</span><span class="p">):</span>  
</span></span><span class="line"><span class="cl">            <span class="n">mp4_file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">directory</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>  
</span></span><span class="line"><span class="cl">            <span class="n">mp3_file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">mp4_file_path</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;.mp3&#39;</span>  
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            <span class="k">try</span><span class="p">:</span>  
</span></span><span class="line"><span class="cl">                <span class="c1"># 使用 moviepy 转换视频为音频  </span>
</span></span><span class="line"><span class="cl">                <span class="n">video_clip</span> <span class="o">=</span> <span class="n">VideoFileClip</span><span class="p">(</span><span class="n">mp4_file_path</span><span class="p">)</span>  
</span></span><span class="line"><span class="cl">                <span class="n">video_clip</span><span class="o">.</span><span class="n">audio</span><span class="o">.</span><span class="n">write_audiofile</span><span class="p">(</span><span class="n">mp3_file_path</span><span class="p">)</span>  
</span></span><span class="line"><span class="cl">                <span class="n">video_clip</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>  
</span></span><span class="line"><span class="cl">                
</span></span><span class="line"><span class="cl">                <span class="c1"># 删除原有的 mp4 文件  </span>
</span></span><span class="line"><span class="cl">                <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">mp4_file_path</span><span class="p">)</span>  
</span></span><span class="line"><span class="cl">                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Converted </span><span class="si">{</span><span class="n">mp4_file_path</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">mp3_file_path</span><span class="si">}</span><span class="s2"> and deleted original mp4 file.&#34;</span><span class="p">)</span>  
</span></span><span class="line"><span class="cl">            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>  
</span></span><span class="line"><span class="cl">                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Error processing </span><span class="si">{</span><span class="n">mp4_file_path</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 设置你的目标目录  </span>
</span></span><span class="line"><span class="cl"><span class="n">target_directory</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;E:\Entertainment\北流嘉措&#39;</span>  
</span></span><span class="line"><span class="cl"><span class="n">convert_mp4_to_mp3</span><span class="p">(</span><span class="n">target_directory</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="最新windows电脑ffmpeg安装教程手把手详解">【最新】windows电脑FFmpeg安装教程手把手详解<a hidden class="anchor" aria-hidden="true" href="#最新windows电脑ffmpeg安装教程手把手详解">#</a></h1>
<p><a href="https://blog.csdn.net/csdn_yudong/article/details/129182648">windows电脑FFmpeg安装教程手把手详解教程来源</a></p>
<p>本文以 Windows 64 位操作系统为例演示</p>
<p>一、下载&amp;解压</p>
<p>打开 <a href="https://ffmpeg.org/download.html">FFmpeg 官网</a>，选择下载。</p>
<p>选择 Windows 平台，下面有两个链接，都是可以的，选择其一。</p>
<p><img alt="w" loading="lazy" src="https://i-blog.csdnimg.cn/blog_migrate/6da51ed4b2b46716f2164b25fd7cd48e.png"></p>
<p>本文以点击第一个链接为例，进去以后，选择左边的 release builds ，右边出现如下内容：</p>
<p><img alt="a" loading="lazy" src="https://i-blog.csdnimg.cn/blog_migrate/4c4679bc18672d25d6f2d371d95733bc.png"></p>
<p>你可以选择下载上面红色圈中的 release-full 版本，或者选择下面红色圈中的前一个稳定版本 xxx-full_build。</p>
<p>release-full 版本会比下面的 xxx-full_build 版本更新，选择哪一个都可以，看你个人喜好。</p>
<p>至于你是想选择带 shared 的还是不带 shared 的版本，其实都是可以的。因为同一个版本带 shared 的和不带 shared 的，功能是完全一样的。</p>
<p>带 shared 的里面，多了 include、lib 目录。把 FFmpeg 依赖的模块包单独的放在的 lib 目录中。ffmpeg.exe，ffplay.exe，ffprobe.exe 作为可执行文件的入口，文件体积很小，他们在运行的时候，如果需要，会到 lib 中调用相应的功能。</p>
<p>不带 shared 的里面，bin 目录中有 ffmpeg.exe，ffplay.exe，ffprobe.exe 三个可执行文件，每个 exe 的体积都稍大一点，因为它已经把相关的需要用的模块包编译到exe里面去了。</p>
<p><img alt="a" loading="lazy" src="https://i-blog.csdnimg.cn/blog_migrate/70582f712c57edf6dc3e58de104ac028.png"></p>
<p>解压以后的内容，如上图所示；进入 bin 目录，复制 bin 目录路径。</p>
<p><img alt="a" loading="lazy" src="https://i-blog.csdnimg.cn/blog_migrate/665ad5f45c6dddc292e0aaf5e5fad8c5.png"></p>
<p>二、配置环境变量</p>
<p>1、配置系统环境变量</p>
<p>1、在电脑桌面上，打开我的电脑</p>
<p>2、在空白处，右键，选择属性</p>
<p>3、选择 高级系统设置 -&gt; 高级 -&gt; 环境变量</p>
<p>4、在系统变量中，选择 Path，然后编辑：</p>
<p>5、然后在出来的编辑环境变量表中，新建一个，将刚才复制的 bin 目录路径粘贴进去，保存即可。</p>
<p>三、验证</p>
<p>重新打开一个命令行窗口，输入： ffmpeg -version，有版本信息输出，则证明配置成功！！</p>
<p>执行Python代码需要重启PyCharm。</p>
<p>额外补充</p>
<p>对于 windows 电脑可以将解压文件放到系统的 system32 目录中去，就不用配置环境变量了。</p>
<h1 id="pydub入门教程">PyDub入门教程<a hidden class="anchor" aria-hidden="true" href="#pydub入门教程">#</a></h1>
<p><a href="https://blog.csdn.net/lsb2002/article/details/135610159">Python音频处理利器：pydub详解</a></p>
<p>Pydub 是一个用 Python 编写的音频处理库，它可以方便地处理许多音频文件，诸如分割、合并、格式转换、音量调节等。它具有以下特点：</p>
<ul>
<li>主要使用 ffmpeg 和 libav 模块来实现音频的读取、处理和输出。</li>
<li>支持的音频格式非常广泛，包括 MP3、WAV、FLAC、MP4 等。</li>
<li>API 简单易用，可以方便地进行常用的音频处理操作。</li>
</ul>
<p>Pydub 是一个轻量级、快速且易于使用的库。silence库是pydub的一个扩展库，可以在音频文件中根据静默部分进行分割，非常方便。</p>
<h2 id="1-pydub安装">1 pydub安装<a hidden class="anchor" aria-hidden="true" href="#1-pydub安装">#</a></h2>
<p>安装 Pydub 的最简单方法是使用 pip，只需在命令行下运行以下命令即可：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">pip install pydub
</span></span></code></pre></td></tr></table>
</div>
</div><p>依赖：需安装ffmpeg或者libav</p>
<p>如果 ffmpeg 或 libav 未安装，则还需要在系统中安装相关依赖库。</p>
<h2 id="2--pydub模块使用">2  pydub模块使用<a hidden class="anchor" aria-hidden="true" href="#2--pydub模块使用">#</a></h2>
<p>读取音频文件非常简单，只需使用 AudioSegment.from_file() 函数即可。以下示例演示了如何读取名为 &ldquo;soundfile.mp3&rdquo; 的 MP3 文件：</p>
<h3 id="21-打开音频文件">2.1 打开音频文件<a hidden class="anchor" aria-hidden="true" href="#21-打开音频文件">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pydub</span> <span class="kn">import</span> <span class="n">AudioSegment</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="c1"># 打开wav格式音频文件</span>
</span></span><span class="line"><span class="cl"><span class="n">sound</span> <span class="o">=</span> <span class="n">AudioSegment</span><span class="o">.</span><span class="n">from_wav</span><span class="p">(</span><span class="s1">&#39;./soundfile.wav&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="c1"># 打开mp3音频文件，AudioSegment原生只支持wav，raw文件，安装ffmpeg可支持其所有格式</span>
</span></span><span class="line"><span class="cl"><span class="n">sound</span> <span class="o">=</span> <span class="n">AudioSegment</span><span class="o">.</span><span class="n">from_mp3</span><span class="p">(</span><span class="s1">&#39;./soundfile.mp3&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="c1"># 打开音频文件，生成AudioSegment对象</span>
</span></span><span class="line"><span class="cl"><span class="n">sound</span> <span class="o">=</span> <span class="n">AudioSegment</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s1">&#39;./soundfile.mp3&#39;</span><span class="p">)</span>	<span class="c1"># format默认值为&#34;mp3&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">sound</span> <span class="o">=</span> <span class="n">AudioSegment</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s1">&#39;./soundfile.wav&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;wav&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="c1"># 打开raw文件需要额外参数，sample_width（采样位数），frame_rate（采样频率），channels（声通道）</span>
</span></span><span class="line"><span class="cl"><span class="c1"># sample_width: 1、8bit，2、16bit，3、32bit</span>
</span></span><span class="line"><span class="cl"><span class="c1"># frame_rate: 44100(44.1kHz CD audio), 48000(48kHz DVD audio)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># channels: 1、单声道，2、立体声</span>
</span></span><span class="line"><span class="cl"><span class="n">sound</span> <span class="o">=</span> <span class="n">AudioSegment</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s1">&#39;./soundfile.raw&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;raw&#39;</span><span class="p">,</span> <span class="n">frame_rate</span><span class="o">=</span><span class="mi">44100</span><span class="p">,</span> <span class="n">channels</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sample_width</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="22-导出音频文件">2.2 导出音频文件<a hidden class="anchor" aria-hidden="true" href="#22-导出音频文件">#</a></h3>
<p>要将 AudioSegment 对象保存为音频文件，可以使用 export() 函数。以下示例将上述读取的音频输出为名为 &ldquo;outputsoundfile.mp3&rdquo; 的 mp3文件：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">sound</span> <span class="o">=</span> <span class="n">AudioSegment</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s1">&#39;./soundfile.wav&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;wav&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="c1"># 导出音频文件</span>
</span></span><span class="line"><span class="cl"><span class="n">sound</span><span class="o">.</span><span class="n">export</span><span class="p">(</span><span class="s1">&#39;./outputsoundfile.mp3&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;mp3&#39;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="23-创建音频文件">2.3 创建音频文件<a hidden class="anchor" aria-hidden="true" href="#23-创建音频文件">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># 生成一个时间长度为0秒的AudioSegment对象，一般用于多个音频合并</span>
</span></span><span class="line"><span class="cl"><span class="n">sound</span> <span class="o">=</span> <span class="n">AudioSegment</span><span class="o">.</span><span class="n">empty</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="c1"># 生成一个时间长度为5秒的无声AduioSegment对象</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 参数duration:时间长度（毫秒），frame_rate:频率，默认为11025Hz</span>
</span></span><span class="line"><span class="cl"><span class="n">sound</span> <span class="o">=</span> <span class="n">AudioSegment</span><span class="o">.</span><span class="n">silent</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mi">50000</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="24-合并音频文件">2.4 合并音频文件<a hidden class="anchor" aria-hidden="true" href="#24-合并音频文件">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># 两个单声道音频合并为一个多声道音频</span>
</span></span><span class="line"><span class="cl"><span class="n">left_channel</span> <span class="o">=</span> <span class="n">AudioSegment</span><span class="o">.</span><span class="n">from_wav</span><span class="p">(</span><span class="s1">&#39;sound_left.wav&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">right_channel</span> <span class="o">=</span> <span class="n">AudioSegment</span><span class="o">.</span><span class="n">from_wav</span><span class="p">(</span><span class="s1">&#39;sound_right.wav&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">stereo_sound</span> <span class="o">=</span> <span class="n">AudioSegment</span><span class="o">.</span><span class="n">from_mono_auidosegments</span><span class="p">(</span><span class="n">left_channel</span><span class="p">,</span><span class="n">right_channel</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 将多声道音频分解成两个单声道</span>
</span></span><span class="line"><span class="cl"><span class="n">sound</span> <span class="o">=</span> <span class="n">AudioSegment</span><span class="o">.</span><span class="n">from_wav</span><span class="p">(</span><span class="s1">&#39;sound.wav&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">sound</span><span class="o">.</span><span class="n">split_to_mono</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="c1"># 两个音频文件合并为一个音频文件</span>
</span></span><span class="line"><span class="cl"><span class="n">sound1</span> <span class="o">=</span> <span class="n">AudioSegment</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s1">&#39;sound1.wav&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;wav&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">sound2</span> <span class="o">=</span> <span class="n">AudioSegment</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s1">&#39;sound2.wav&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;wav&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 无交叉淡入淡出</span>
</span></span><span class="line"><span class="cl"><span class="n">sound</span> <span class="o">=</span> <span class="n">sound1</span> <span class="o">+</span> <span class="n">sound2</span>
</span></span><span class="line"><span class="cl"><span class="c1"># OR</span>
</span></span><span class="line"><span class="cl"><span class="n">sound</span> <span class="o">=</span> <span class="n">sound1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sound2</span><span class="p">,</span> <span class="n">crossfade</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 淡入淡出，参数crossfade:效果持续时间，默认100毫秒</span>
</span></span><span class="line"><span class="cl"><span class="n">sound</span> <span class="o">=</span> <span class="n">sound1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sound2</span><span class="p">,</span> <span class="n">crossfade</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="c1"># 两个音频文件叠加为一个音频文件</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 例，长音频sound1，30s</span>
</span></span><span class="line"><span class="cl"><span class="n">sound1</span> <span class="o">=</span> <span class="n">AudioSegment</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s1">&#39;sound1.wav&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;wav&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 例，短音频sound2，10s</span>
</span></span><span class="line"><span class="cl"><span class="n">sound2</span> <span class="o">=</span> <span class="n">AudioSegment</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s1">&#39;sound2.wav&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;wav&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 将sound2叠加至sound1上，参数postions:从sound1音频10秒处开始叠加，默认为0，得到的音频文件，会从10秒处开始出现sound2音频，20秒处sound2音频结束，只余sound1音频</span>
</span></span><span class="line"><span class="cl"><span class="n">sound</span> <span class="o">=</span> <span class="n">sound1</span><span class="o">.</span><span class="n">overlay</span><span class="p">(</span><span class="n">sound2</span><span class="p">,</span> <span class="n">postions</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 将sound2叠加至sound1上，参数loop:开启循环，默认为Fasle，得到的音频文件sound2将会循环播放至sound1结束</span>
</span></span><span class="line"><span class="cl"><span class="n">sound</span> <span class="o">=</span> <span class="n">sound1</span><span class="o">.</span><span class="n">overlay</span><span class="p">(</span><span class="n">sound2</span><span class="p">,</span> <span class="n">loop</span><span class="o">=</span><span class="n">true</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 将sound2叠加至sound1上，参数times:重复次数，默认为1，得到的音频文件sound2将会重复两次，在两个sound2的时间结束sound2音频</span>
</span></span><span class="line"><span class="cl"><span class="n">sound</span> <span class="o">=</span> <span class="n">sound1</span><span class="o">.</span><span class="n">overlay</span><span class="p">(</span><span class="n">sound2</span><span class="p">,</span> <span class="n">times</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 将sound1叠加至sound2上，10秒后sound2音频结束，sound1音频截断至10s结束，最终该音频长度只有10s，即</span>
</span></span><span class="line"><span class="cl"><span class="n">sound</span> <span class="o">=</span> <span class="n">sound2</span><span class="o">.</span><span class="n">overlay</span><span class="p">(</span><span class="n">sound1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">len</span><span class="p">(</span><span class="n">sound</span><span class="p">)</span> <span class="o">==</span> <span class="n">sound2</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="25-音频文件信息">2.5 音频文件信息<a hidden class="anchor" aria-hidden="true" href="#25-音频文件信息">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">sound</span> <span class="o">=</span> <span class="n">AudioSegment</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s1">&#39;soundfile.wav&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;wav&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="c1"># 声道数</span>
</span></span><span class="line"><span class="cl"><span class="n">schannel</span> <span class="o">=</span> <span class="n">sound</span><span class="o">.</span><span class="n">channels</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="c1"># 采样位数，也称位深度，是指每个采样样本所包含的位数（字节数），通常有8 bit、16 bit</span>
</span></span><span class="line"><span class="cl"><span class="n">sbytes</span> <span class="o">=</span> <span class="n">sound</span><span class="o">.</span><span class="n">sample_width</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="c1"># 采样频率，也称采样率，是指在单位时间内对声音信号的采样数或样本数，采样频率越能高表现的频率范围越大（电话：8kHZ，无线电广播：22.05kHz，CD：44.1kHz，DVD：48kHZ，蓝光：96kHz，192kHz）</span>
</span></span><span class="line"><span class="cl"><span class="n">srate</span> <span class="o">=</span> <span class="n">sound</span><span class="o">.</span><span class="n">frame_rate</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="c1"># 帧位数, 帧包含每个声道的采样位数frame_width = channels * sample_width</span>
</span></span><span class="line"><span class="cl"><span class="n">sframebytes</span> <span class="o">=</span> <span class="n">sound</span><span class="o">.</span><span class="n">frame_width</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="c1"># 音频文件帧数, 可选参数ms:时间长度，默认None</span>
</span></span><span class="line"><span class="cl"><span class="n">sframe</span> <span class="o">=</span> <span class="n">sound</span><span class="o">.</span><span class="n">frame_count</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="c1"># 音频文件时长，单位秒</span>
</span></span><span class="line"><span class="cl"><span class="n">stime</span> <span class="o">=</span> <span class="n">sound</span><span class="o">.</span><span class="n">duration_seconds</span>
</span></span><span class="line"><span class="cl"><span class="c1"># OR</span>
</span></span><span class="line"><span class="cl"><span class="n">stime</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sound</span><span class="p">)</span> <span class="o">/</span> <span class="mi">1000</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="26-处理音频文件">2.6 处理音频文件<a hidden class="anchor" aria-hidden="true" href="#26-处理音频文件">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">sound</span> <span class="o">=</span> <span class="n">AudioSegment</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s1">&#39;soundfile.wav&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;wav&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="c1"># 音频前5秒，pydub中时间以毫秒（ms）为单位</span>
</span></span><span class="line"><span class="cl"><span class="n">audio_begin</span> <span class="o">=</span> <span class="n">sound</span><span class="p">[:</span><span class="mi">5000</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 音频后5秒，pydub中时间以毫秒（ms）为单位</span>
</span></span><span class="line"><span class="cl"><span class="n">audio_end</span> <span class="o">=</span> <span class="n">sound</span><span class="p">[</span><span class="o">-</span><span class="mi">5000</span><span class="p">:]</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="c1"># 改变音频幅度，以分贝（dB）为单位</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 调高幅度</span>
</span></span><span class="line"><span class="cl"><span class="n">raise_via</span> <span class="o">=</span> <span class="n">sound</span><span class="o">.</span><span class="n">apply_gain</span><span class="p">(</span><span class="o">+</span><span class="mi">5</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">raise_via</span> <span class="o">=</span> <span class="n">sound</span> <span class="o">+</span> <span class="mi">5</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 调低音量</span>
</span></span><span class="line"><span class="cl"><span class="n">lower_via</span> <span class="o">=</span> <span class="n">sound</span><span class="o">.</span><span class="n">apply_gain</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">lower_via</span> <span class="o">=</span> <span class="n">sound</span> <span class="o">-</span> <span class="mi">5</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="c1"># 淡入淡出效果</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 淡入，参数duration:持续时间</span>
</span></span><span class="line"><span class="cl"><span class="n">sound</span><span class="o">.</span><span class="n">fade_in</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mi">5000</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 淡出，参数duration:持续时间</span>
</span></span><span class="line"><span class="cl"><span class="n">sound</span><span class="o">.</span><span class="n">fade_out</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mi">5000</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="c1"># 倒放音频文件</span>
</span></span><span class="line"><span class="cl"><span class="n">newsound</span> <span class="o">=</span> <span class="n">sound</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="27-播放音频文件">2.7 播放音频文件<a hidden class="anchor" aria-hidden="true" href="#27-播放音频文件">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pydub</span> <span class="kn">import</span> <span class="n">playback</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pydub</span> <span class="kn">import</span> <span class="n">AduioSegment</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pydub.playback</span> <span class="kn">import</span> <span class="n">play</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="n">sound</span> <span class="o">=</span> <span class="n">AduioSegment</span><span class="o">.</span><span class="n">from_wav</span><span class="p">(</span><span class="s1">&#39;sound.wav&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="c1"># 播放音频</span>
</span></span><span class="line"><span class="cl"><span class="n">play</span><span class="p">(</span><span class="n">sound</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="28-分割音频">2.8 分割音频<a hidden class="anchor" aria-hidden="true" href="#28-分割音频">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pydub</span> <span class="kn">import</span> <span class="n">utils</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pydub</span> <span class="kn">import</span> <span class="n">AudioSegment</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pydub.utils</span> <span class="kn">import</span> <span class="n">make_chanks</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="n">sound</span> <span class="o">=</span> <span class="n">AduioSegment</span><span class="o">.</span><span class="n">from_wav</span><span class="p">(</span><span class="s1">&#39;sound.wav&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="c1"># 分割音频, 参数chunk_length:一段音频多长时间</span>
</span></span><span class="line"><span class="cl"><span class="n">make_chanks</span><span class="p">(</span><span class="n">sound</span><span class="p">,</span> <span class="n">chunk_length</span><span class="o">=</span><span class="mi">5000</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="3-使用pydub根据静音分割音频">3 使用pydub根据静音分割音频<a hidden class="anchor" aria-hidden="true" href="#3-使用pydub根据静音分割音频">#</a></h2>
<h3 id="31-静音检测原理">3.1 静音检测原理<a hidden class="anchor" aria-hidden="true" href="#31-静音检测原理">#</a></h3>
<p>静音检测原理是通过分析音频信号的能量，判断其是否为静音状态。具体的原理如下：</p>
<p>音频信号通常可以用时域或频域来表示。对于时域表示，可以将音频信号分成一段一段的小块，每个小块称为帧。对于频域表示，可以将音频信号变换为频谱图。</p>
<p>静音的特点是信号的能量较低，通常处于接近零的水平。因此，静音检测可以通过计算每个帧或频谱图的能量来判断是否为静音。</p>
<p>计算能量的方法可以使用绝对能量或相对能量。绝对能量是指计算信号的平方和，即将信号的每个样本取平方后相加。相对能量是指计算信号的功率谱密度，即将信号的功率谱密度求和。</p>
<p>静音检测的阈值是根据实际应用来确定的。通常可以根据经验设置一个合适的阈值，当帧的能量或频谱图的能量低于阈值时，被判断为静音。</p>
<p>静音检测也可以结合其他特征进行判断，例如零交叉率、短时过零率等。这些特征可以提供更准确的静音检测结果。</p>
<p>静音检测原理是通过计算音频信号的能量来判断是否为静音状态，通常通过设置一个阈值来判断。此外，还可以结合其他特征进行判断，提高检测的准确性。</p>
<p>语音和噪声的区别可以体现在他们的能量上，语音段的能量比噪声段的能量大，如果环境噪声和系统输入的噪声比较小，只要计算输入信号的短时能量就能够把语音段和噪声背景区分开，除此之外，用基于能量的算法来检测浊音通常效果也是比较理想的，因为浊音的能量值比清音大得多，可以判断浊音和清音之间过渡的时刻，但对清音来说，效果不是很好，因此还需要借助短时过零率来表征。</p>
<p>短时能量可以近似为互补的情况，短时能量大的地方过零率小，短时能量小的地方过零率较大。</p>
<p>基于短时能量和过零率的检测方法 尽管基于短时能量和过零率的检测方法各有其优缺点，但是若将这两种基本方法相结合起来使用也可以实现对语音信号可靠的端点检测。无声段的短时能量为零，清音段的短时能量又比浊音段的短时能量大，而在过零率方面，理想的情况是无声段的过零率为零，浊音段的过零率比清音段的过零率要大的多，假设有一段语音，如果某部分短时能量和过零率都为零或者为很小的值，就可以认为这部分为无声段。</p>
<p>如果该部分语音短时能量很大但是过零率很小，则认为该部分语音为浊音段。</p>
<p>如果该部分短时能量很小但是过零率很大，则认为该部分语音为清音段。</p>
<p>正如前面提到，语音信号具有短时性，因此在对语音信号进行分析时，需要将语音信号以30ms为一段分为若干帧来进行分析，则两帧起始点之间的间隔为10ms。</p>
<p>短时能量，无声&lt;浊音&lt;清音</p>
<p>过零率，无声&lt;清音&lt;浊音</p>
<h3 id="32-使用pydub进行静音检测">3.2 使用pydub进行静音检测<a hidden class="anchor" aria-hidden="true" href="#32-使用pydub进行静音检测">#</a></h3>
<p>代码首先使用AudioSegment类从audio.mp3文件中读取音频数据，然后设置了分割参数min_silence_len、silence_thresh和keep_silence。min_silence_len是最小静音长度，silence_thresh是静音阈值，keep_silence是保留静音长度。这些参数的具体含义可以根据实际情况进行调整。最后，根据分割参数使用split_on_silence函数对音频文件进行分割。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pydub</span> <span class="kn">import</span> <span class="n">AudioSegment</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pydub.silence</span> <span class="kn">import</span> <span class="n">split_on_silence</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="c1"># 读取音频文件</span>
</span></span><span class="line"><span class="cl"><span class="n">audio</span> <span class="o">=</span> <span class="n">AudioSegment</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s2">&#34;D:/dataset/lyb01.wav&#34;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&#34;wav&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="c1"># 设置分割参数</span>
</span></span><span class="line"><span class="cl"><span class="n">min_silence_len</span> <span class="o">=</span> <span class="mi">300</span>  <span class="c1"># 最小静音长度</span>
</span></span><span class="line"><span class="cl"><span class="n">silence_thresh</span> <span class="o">=</span> <span class="o">-</span><span class="mi">50</span>  <span class="c1"># 静音阈值，越小越严格</span>
</span></span><span class="line"><span class="cl"><span class="n">keep_silence</span> <span class="o">=</span> <span class="mi">200</span>  <span class="c1"># 保留静音长度</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="c1"># 分割音频文件</span>
</span></span><span class="line"><span class="cl"><span class="n">segments</span> <span class="o">=</span> <span class="n">split_on_silence</span><span class="p">(</span><span class="n">audio</span><span class="p">,</span> <span class="n">min_silence_len</span><span class="o">=</span><span class="n">min_silence_len</span><span class="p">,</span> <span class="n">silence_thresh</span><span class="o">=</span><span class="n">silence_thresh</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                            <span class="n">keep_silence</span><span class="o">=</span><span class="n">keep_silence</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">segments</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">    <span class="n">segments</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">export</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;wav_</span><span class="si">{</span><span class="n">idx</span><span class="si">:</span><span class="s1">04</span><span class="si">}</span><span class="s1">.wav&#39;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="4-总结">4 总结<a hidden class="anchor" aria-hidden="true" href="#4-总结">#</a></h2>
<p>通过pydub，我们可以方便地进行音频编解码、混音、重采样等操作，进一步扩展了pydub的应用场景。需要注意的是，在进行音频混音操作时，需要保证两个音频文件的采样率、采样位数和声道数相同。</p>
<p>pydub优点：</p>
<p>轻量级：pydub是一个轻量级的音频处理库，安装方便，使用简单。</p>
<p>功能丰富：pydub提供了丰富的音频处理功能，包括切割、合并、转换、调整音量、编解码、混音、重采样等。</p>
<p>应用广泛：pydub的应用场景非常广泛，包括音频处理、铃声制作、音频格式转换、语音识别等等。</p>
<p>pydub缺点：</p>
<p>对格式的兼容性有限：pydub对音频格式的兼容性有限，不支持所有的音频格式，需要先将音频转换为支持的格式后才能进行处理。</p>
<p>性能一般：pydub在处理大文件时，性能可能会比较一般，需要耗费一定的时间和计算资源。
不支持流式处理：pydub不支持流式处理，需要将整个音频文件读取到内存中，导致内存占用较大。</p>
<p>pydub是一个功能丰富、应用广泛的音频处理库。在使用pydub时，需要注意音频格式的兼容性问题，并注意处理大文件时的性能和内存占用。如果需要处理更复杂的音频任务，可以考虑使用其他更专业的音频处理库。</p>
<h1 id="moviepy入门教程">MoviePy入门教程<a hidden class="anchor" aria-hidden="true" href="#moviepy入门教程">#</a></h1>
<p>Video editing with Python</p>
<p><a href="https://zulko.github.io/moviepy/" title="https://zulko.github.io/moviepy/">zulko.github.io/moviepy/</a></p>
<p>MoviePy (online documentation <a href="https://zulko.github.io/moviepy/">here</a>) is a Python library for video editing: cuts, concatenations, title insertions, video compositing (a.k.a. non-linear editing), video processing, and creation of custom effects.</p>
<p>MoviePy can read and write all the most common audio and video formats, including GIF, and runs on Windows/Mac/Linux, with Python 3.9+.</p>
<h2 id="example">Example<a hidden class="anchor" aria-hidden="true" href="#example">#</a></h2>
<p>In this example we open a video file, select the subclip between 10 and 20 seconds, add a title at the center of the screen, and write the result to a new file:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">moviepy</span> <span class="kn">import</span> <span class="n">VideoFileClip</span><span class="p">,</span> <span class="n">TextClip</span><span class="p">,</span> <span class="n">CompositeVideoClip</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Load file example.mp4 and keep only the subclip from 00:00:10 to 00:00:20</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Reduce the audio volume to 80% of its original volume</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">clip</span> <span class="o">=</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">VideoFileClip</span><span class="p">(</span><span class="s2">&#34;long_examples/example2.mp4&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">subclipped</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">with_volume_scaled</span><span class="p">(</span><span class="mf">0.8</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Generate a text clip. You can customize the font, color, etc.</span>
</span></span><span class="line"><span class="cl"><span class="n">txt_clip</span> <span class="o">=</span> <span class="n">TextClip</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">font</span><span class="o">=</span><span class="s2">&#34;Arial.ttf&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">text</span><span class="o">=</span><span class="s2">&#34;Hello there!&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">font_size</span><span class="o">=</span><span class="mi">70</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span><span class="o">.</span><span class="n">with_duration</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">with_position</span><span class="p">(</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Overlay the text clip on the first video clip</span>
</span></span><span class="line"><span class="cl"><span class="n">final_video</span> <span class="o">=</span> <span class="n">CompositeVideoClip</span><span class="p">([</span><span class="n">clip</span><span class="p">,</span> <span class="n">txt_clip</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="n">final_video</span><span class="o">.</span><span class="n">write_videofile</span><span class="p">(</span><span class="s2">&#34;result.mp4&#34;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="how-moviepy-works">How MoviePy works<a hidden class="anchor" aria-hidden="true" href="#how-moviepy-works">#</a></h2>
<p>Under the hood, MoviePy imports media (video frames, images, sounds) and converts them into Python objects (numpy arrays) so that every pixel becomes accessible, and video or audio effects can be defined in just a few lines of code (see the <a href="https://github.com/Zulko/moviepy/blob/master">built-in effects</a> for examples).</p>
<p>The library also provides ways to mix clips together (concatenations, playing clips side by side or on top of each other with transparency, etc.). The final clip is then encoded back into mp4/webm/gif/etc.</p>
<p>This makes MoviePy very flexible and approachable, albeit slower than using ffmpeg directly due to heavier data import/export operations.</p>
<h2 id="installation">Installation<a hidden class="anchor" aria-hidden="true" href="#installation">#</a></h2>
<p>Intall moviepy with <code>pip install moviepy</code>. For additional installation options, such as a custom FFMPEG or for previewing, see <a href="https://zulko.github.io/moviepy/getting_started/install.html">this section</a>. For development, clone that repo locally and install with <code>pip install -e .</code></p>
<h2 id="documentation">Documentation<a hidden class="anchor" aria-hidden="true" href="#documentation">#</a></h2>
<p>The online documentation (<a href="https://zulko.github.io/moviepy/">here</a>) is automatically built at every push to the master branch. To build the documentation locally, install the extra dependencies via <code>pip install moviepy[doc]</code>, then go to the <code>docs</code> folder and run <code>make html</code>.</p>
<h2 id="moviepy一个超酷的-python-库">moviepy，一个超酷的 Python 库！<a hidden class="anchor" aria-hidden="true" href="#moviepy一个超酷的-python-库">#</a></h2>
<p><a href="https://zhuanlan.zhihu.com/p/680555324">文章来源</a></p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://rosefinch-midsummer.github.io/zh/tags/python/">Python</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="https://rosefinch-midsummer.github.io/zh/posts/book/%E7%8B%AC%E7%94%9F%E5%AD%90%E5%A5%B3%E7%A5%9E%E8%AF%9D/">
    <span class="title">« 上一頁</span>
    <br>
    <span>《独生子女神话》</span>
  </a>
  <a class="next" href="https://rosefinch-midsummer.github.io/zh/posts/book/%E9%9D%92%E6%A5%BC%E9%9F%B5%E8%AF%AD/">
    <span class="title">下一頁 »</span>
    <br>
    <span>《青楼韵语》</span>
  </a>
</nav>

  </footer>
<div>    
    <div class="pagination__title">
        <span class="pagination__title-h" style="font-size: 20px;">评论</span>
        <br/>
    </div>
    <div id="tcomment"></div>
    <script src="https://utteranc.es/client.js"
            repo="Rosefinch-Midsummer/comments_of_blog" 
            issue-term="title"
            theme="github-light"
            crossorigin="anonymous"
            async>
    </script>
    <script>
        document.getElementById("theme-toggle").addEventListener("click", () => {
            const theme = document.body.className.includes("dark")
            ? "github-light"
            : "photon-dark";
            const message = {
            type: "set-theme",
            theme: theme,
            };
            const utteranc = document.querySelector(".utterances-frame");
            utteranc.contentWindow.postMessage(message, "https://utteranc.es");
        });
    </script>
</div>






</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2025 <a href="https://rosefinch-midsummer.github.io/zh/">天漢帝國復興錄</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
  
<div class="busuanzi-footer">
  <span id="busuanzi_container_site_pv">
    本站总访问量<span id="busuanzi_value_site_pv"></span>次
  </span>
  <span id="busuanzi_container_site_uv">
    本站访客数<span id="busuanzi_value_site_uv"></span>人次
  </span>
</div></footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = '複製';

        function copyingDone() {
            copybutton.innerHTML = '已複製！';
            setTimeout(() => {
                copybutton.innerHTML = '複製';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>




</body>

</html>
